{
  "version": "1.0",
  "projectName": "pii-scrub",
  "description": "Scrub PII from skills examples and artifacts, then purge from git history",
  "stories": [
    {
      "id": "story-ml4lt7m0",
      "title": "Create PII scrubbing utility script",
      "description": "Create scripts/scrub-pii.ts that:\n1. Detects emails (regex), names (from context), phone numbers, addresses\n2. Replaces with redacted placeholders: [EMAIL], [NAME], [PHONE], etc.\n3. Processes .md and .json files recursively\n4. Has --dry-run mode to preview changes\n5. Reports count of redactions per file\n\nUse Bun. Keep it simple - regex-based detection is fine for emails/phones. For names, look for patterns like \"Hi [Name],\" or \"Thanks, [Name]\" in the conversation context.",
      "priority": 1,
      "passes": true,
      "validationCommand": "test -f scripts/scrub-pii.ts && bun run scripts/scrub-pii.ts --dry-run skills/access-locked-out/examples/real-responses.md 2>&1 | grep -q 'EMAIL\\|redact'"
    },
    {
      "id": "story-ml4lt7md",
      "title": "Scrub PII from all skill example files",
      "description": "Run the scrub-pii script on all files in skills/*/examples/*.md and skills/*/*.md\n\nReplace all detected PII with redacted placeholders. Verify no raw emails remain after scrubbing.\n\nRun: bun run scripts/scrub-pii.ts skills/",
      "priority": 2,
      "passes": true,
      "validationCommand": "! grep -r -E '[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}' skills/ --include=\"*.md\" 2>/dev/null | grep -v '\\[EMAIL\\]' | grep -q '@'"
    },
    {
      "id": "story-ml4lt7mg",
      "title": "Scrub or remove PII from artifacts directory",
      "description": "The artifacts/ directory contains extracted data with PII. Options:\n1. If artifacts are gitignored and not needed in repo: delete them\n2. If they need to stay: scrub PII from all .json and .jsonl files\n\nCheck if artifacts/ is in .gitignore. If not, add it. Then either scrub or delete the PII-containing files.\n\nPreferred: Add artifacts/ to .gitignore and delete the PII-containing files (they can be regenerated).",
      "priority": 3,
      "passes": true,
      "validationCommand": "grep -q 'artifacts/' .gitignore && ! find artifacts -name \"*.json\" -exec grep -l -E '[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}' {} \\; 2>/dev/null | grep -q '.'"
    },
    {
      "id": "story-ml4lt7ml",
      "title": "Commit scrubbed files and prepare git history purge",
      "description": "1. Stage and commit all scrubbed files with message \"chore: scrub PII from examples and artifacts\"\n2. Create scripts/purge-history.sh that uses git-filter-repo to:\n   - Remove artifacts/ from all history\n   - Remove any .json files that contained PII\n   - Rewrite commits that touched skill examples\n3. Add instructions to progress.txt for manual execution\n\nDO NOT run the history purge automatically - just prepare the script. This is destructive and needs human approval.",
      "priority": 4,
      "passes": false,
      "validationCommand": "git log -1 --oneline | grep -qi 'scrub\\|pii' && test -f scripts/purge-history.sh"
    }
  ],
  "metadata": {
    "createdAt": "2026-02-02T03:21:55.559Z",
    "totalIterations": 3,
    "lastIteration": "2026-02-02T03:24:03.248Z"
  }
}